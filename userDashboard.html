<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
    <link rel="stylesheet" href="Dashboard.css" />
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">

    <title>User Dashboard</title>
</head>

<body data>
    <div class="d-flex" id="wrapper">


        <div style="background: linear-gradient(90deg, rgba(184,182,211,1) 0%, rgba(255,255,255,1) 100%, rgba(0,212,255,1) 100%);"
            id="sidebar-wrapper" id="sidebar-wrapper">

            <div style="color: black; text-decoration: underline; border-bottom: 2px solid black;"
                class=" sidebar-heading text-center py-4 primary-text fs-4 fw-bold text-uppercase  ">
                <i class="fas fa-user-secret me-3 "></i>User
            </div>
            <div class="list-group list-group-flush my-3" data-aos="fade-down-right">

               

                <a href="allProducts.html"
                    class="list-group-item list-group-item-action bg-transparent second-text fw-bold"><i
                        class="fas fa-gift me-2"></i> All Products</a>

                
                <a href="invoice.html"
                    class="list-group-item list-group-item-action bg-transparent second-text fw-bold"><i
                        class="fas fa-file-invoice me-2"></i>Generate invoice</a>


                <!-- <a href="#" class="list-group-item list-group-item-action bg-transparent second-text fw-bold"><i class="fas fa-map-marker-alt me-2"></i>Our Outlet</a>
                 -->
                
            </div>
        </div>


        <div id="page-content-wrapper" style="border-left: 5px solid green;">

            <nav style="border-bottom: 2px solid black;"
                class="navbar navbar-expand-lg navbar-light bg-transparent    py-4 px-5">

                <div class="d-flex align-items-center ">
                    <i style="color: red;" class="fas fa-align-left primary-text fs-4 me-3 " id="menu-toggle"></i>
                    <h2 class="fs-2 m-0">Dashboard</h2>
                </div>

                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
                    aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse " id="navbarSupportedContent">
                    <ul class="navbar-nav ms-auto mb-2 mb-lg-0 ">
                        <li class="nav-item dropdown px-3">
                            <a class="nav-link dropdown-toggle second-text fw-bold" href="#" id="navbarDropdown"
                                role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class=" fas fa-wheelchair me-2"></i>Profile
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item" href="#">Profile</a></li>
                                <li><a class="dropdown-item" href="#">Settings</a></li>
                                <li><a class="dropdown-item" href="login.html">Logout</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown px-3">
                            <a class="nav-link dropdown-toggle second-text fw-bold" href="#" id="navbarDropdown"
                                role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                <i class=" fas fa-screwdriver me-2"></i> Settings
                            </a>
                            <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                                <li><a class="dropdown-item" href="#">Gneral</a></li>
                                <li><a class="dropdown-item" href="#">Payment</a></li>
                            </ul>
                        </li>

                    </ul>
                </div>
            </nav>


            <div class="container-fluid px-4">
                <center>
                    <h2 class="fs-2 mt-4 mb-0 text-decoration-underline"> Updates</h2>
                </center>

                <div class="row g-3 my-4" data-aos="fade-down">
                    <div class="col-md-3 ">
                        <div class="p-3  bg-white shadow-sm d-flex justify-content-around align-items-center rounded">
                            <div>
                                <h3 class="fs-2" id="totalProducts">720</h3>
                                <p class="fs-5">Products</p>
                            </div>
                            <i
                                class="fas fa-gift fs-1 primary-text border rounded-full secondary-bg p-3 d-md-none d-lg-block"></i>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="p-3 bg-white shadow-sm d-flex justify-content-around align-items-center rounded">
                            <div>
                                <h3 class="fs-2" id="totalInvoices">4920</h3>
                                <p class="fs-5" >Sales</p>
                            </div>
                            <i
                                class="fas fa-hand-holding-usd d-md-none d-lg-block fs-1 primary-text border rounded-full secondary-bg p-3"></i>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="p-3 bg-white shadow-sm d-flex justify-content-around align-items-center rounded">
                            <div>
                                <h3 class="fs-2"id="totalVendors">3899</h3>
                                <p class="fs-5">Vendors</p>
                            </div>
                            <i
                                class="fas fa-truck fs-1 primary-text d-md-none d-lg-block border rounded-full secondary-bg p-3"></i>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="p-3 bg-white shadow-sm d-flex  justify-content-around align-items-center rounded">
                            <div>
                                <h3 class="fs-2">%25</h3>
                                <p class="fs-5">Increase</p>
                            </div>
                            <i
                                class="fas fa-chart-line fs-1 d-md-none d-lg-block primary-text border rounded-full secondary-bg p-3"></i>
                        </div>
                    </div>
                </div>


                <div class="row my-5  ">

                    <center>
                        <h4 class="fs-2  mb-5 text-decoration-underline"> Recent Orders</h4>
                    </center>

                    <div class="table-responsive px-5 " data-aos="fade-up">
                        <table class="table bg-white rounded shadow-sm table-hover table-striped w-100">
                            <thead>
                                <tr class="bg-success">
                                    <th scope="col" width="100">#</th>
                                    <th scope="col">Product Name</th>
                                    <th scope="col">Product Price</th>
                                    <th scope="col">Quantity Purchased</th>
                                    <th scope="col">Total Bill</th>
                                    <th scope="col">Invoice ID</th>
                                </tr>
                            </thead>
                            <tbody id="recentOrdersBody">
                                
                            </tbody>
                        </table>
                    </div>

                </div>

            </div>
        </div>
    </div>

    </div>




    <script>

        AOS.init({
            duration: 1500
        });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        
        var el = document.getElementById("wrapper");
        var toggleButton = document.getElementById("menu-toggle");

        toggleButton.onclick = function () {
            el.classList.toggle("toggled");
        };
    document.addEventListener('DOMContentLoaded', async () => {
        try {
            const response = await fetch('http://localhost:3000/products/count');
            const data = await response.json();
            const totalProducts = data.totalProducts;

            // Update the total products count on the dashboard
            const totalProductsElement = document.getElementById('totalProducts');
            totalProductsElement.textContent = totalProducts;
        } catch (error) {
            console.error('Error fetching total products:', error);
        }
    });
    document.addEventListener('DOMContentLoaded', async () => {
        try {
            const response = await fetch('http://localhost:3000/invoices/count');
            const data = await response.json();
            const totalInvoices = data.totalInvoices;

            // Update the total invoices count on the dashboard
            const totalInvoicesElement = document.getElementById('totalInvoices');
            totalInvoicesElement.textContent = totalInvoices;
        } catch (error) {
            console.error('Error fetching total invoices:', error);
        }
    });
    document.addEventListener('DOMContentLoaded', async () => {
        try {
            const response = await fetch('http://localhost:3000/vendors/count');
            const data = await response.json();
            const totalVendors = data.totalVendors;

            // Update the total vendors count on the dashboard
            const totalVendorsElement = document.getElementById('totalVendors');
            totalVendorsElement.textContent = totalVendors;
        } catch (error) {
            console.error('Error fetching total vendors:', error);
        }
    });
    document.addEventListener('DOMContentLoaded', async () => {
            try {
                const response = await fetch('http://localhost:3000/recentOrders');
                const data = await response.json();

                // Reference to the tbody element
                const recentOrdersBody = document.getElementById('recentOrdersBody');

                // Clear any existing rows
                recentOrdersBody.innerHTML = '';
// console.log(data);
                // Iterate over the data and create table rows
                data.forEach((order, index) => {
                    const row = `
                        <tr>
                            <th scope="row">${index + 1}</th>
                            <td>${order.name}</td>
                            <td>Rs. ${order.Price}</td>
                            <td>${order.quantity}</td>
                            <td>Rs. ${order.totalPrice}</td>
                            <td>${order.invoiceId}</td>
                        </tr>
                    `;
                    // Append the row to the tbody
                    recentOrdersBody.innerHTML += row;
                });
            } catch (error) {
                console.error('Error fetching recent orders:', error);
            }
        });
    </script>
</body>

</html>